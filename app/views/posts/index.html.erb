<% if user_signed_in? %>
  <h1 class="text-center">武将一覧</h1>

  <div class="form">
    <%= search_form_for @q do |f| %>
      <%= f.label :name_cont, "武将名" %>
      <%= f.search_field :name_cont, size: 15 %>&emsp;
      <%= f.label :furigana_initial_cont, "武将名(50音)" %>
      <%= f.collection_select :furigana_initial_cont, Furigana.all, :ini, :ini, {include_blank: "---"} %>&emsp;
      <%= f.label :prefecture_name_cont, "出身地" %>
      <%= f.collection_select :prefecture_name_cont, Prefecture.all, :name, :name, {include_blank: "---"} %>
      <%= f.submit "検索" %>
    <% end %>
  </div>

  <div class="row row-cols-2 row-cols-md-4 g-4">
  <% @posts.each do |post| %>
    <div class="col">
      <div class="card h-100 text-card-container">
        <%= image_tag post.image.url, :size => "150", :align => "center" %>
        <div class="card-body">
          <h5 class="card-title"><b><%= post.name %></b></h5>
          <p class="card-text"><%= post.commentary %></p>
          <%= link_to post, class: "btn btn-primary" do %>
            <i class="fas fa-envelope-open-text"></i> <span class="d-none d-md-inline"> 詳細</span>
          <% end %>
          <p id="post-<%= post.id %>">
            <% if post.liked_by?(current_user) %>
              <%= link_to "💖", post_likes_path(post), method: :delete, remote: true %>
              <%= post.likes_count %>
            <% else %>
              <%= link_to "🤍", post_likes_path(post), method: :post, remote: true %>
              <%= post.likes_count %>
            <% end %>
          </p>
        </div>
      </div>
    </div>
  <% end %>
  </div>

<div class="pagination justify-content-center">
  <%= paginate @posts %>
</div>

<% else %>
  <%= render "layouts/top" %>
<% end %>