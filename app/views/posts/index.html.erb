<h1>武将検索</h1>

<div class="text-center">
  <%= link_to ranks_posts_path, class: "btn btn-index btn-lg" do %>
    <i class="fa-solid fa-ranking-star"></i>&nbsp;<span>武将ランキング</span>
  <% end %>
  &nbsp;&nbsp;&nbsp;&nbsp;
  <%= link_to prefecture_posts_path, class: "btn btn-index btn-lg" do %>
    <i class="fa-solid fa-vihara"></i>&nbsp;<span>出身地で探す</span>
  <% end %>
</div>

<div class="m-auto text-center">
  <% Post.furigana_initials.keys.each do |i| %>
    <%= link_to "#{i}", posts_path(furigana_initial: "#{i}"), class: "btn btn-furigana btn-lg" %>
  <% end %>
</div>

<div class="row my-3 justify-content-center">
  <div class="col-auto">
    <%= search_form_for @q do |f| %>
      <%= f.search_field :name_or_furigana_name_cont, placeholder: "武将名で検索", class: "form-control" %>
  </div>
      <div class="col-auto">
        <%= button_tag type: 'submit', class: 'btn btn-search' do %>
          <i class="fa-solid fa-magnifying-glass"></i>
        <% end %>
    <% end %>
      </div>
</div>

<% if params[:q] != nil %>
  <% if @q_result.present? %>
    <p class="text-center">検索結果&nbsp;<%= @q_result.count %>件</p>

  <% else %>
    <div class="text-center">
      <p>検索に一致する武将がいません</p>
      <%= link_to new_post_path, class: "btn btn-comment-search" do %>
        <i class="fa-regular fa-square-plus"></i>&nbsp;<span>武将の登録はこちら</span>
      <% end %>
    </div>
  <% end %>
<% end %>

<% if params[:furigana_initial].present? %>
  <p class="text-center">検索結果&nbsp;<%= Post.select_furigana_initial(params[:furigana_initial]).count %>件</p> 
<% end %>

<section class="row g-4 card-area">
  <%= render @posts %>
</section>

<section class="pagination justify-content-center">
  <%= paginate @posts %>
</section>